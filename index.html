<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English Grammar Learning</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Noto Sans JP',sans-serif;background:#f0f4f8;color:#1e293b;min-height:100vh}
header{background:linear-gradient(135deg,#1e293b,#334155);color:#fff;padding:20px 24px;text-align:center}
header h1{font-size:1.8rem;font-weight:700;letter-spacing:.05em}
header p{font-size:.9rem;color:#94a3b8;margin-top:4px}

/* Study Mode Toggle */
.study-mode-bar{background:#1e293b;padding:8px 24px;display:flex;align-items:center;justify-content:flex-end;gap:12px}
.study-mode-bar label{color:#94a3b8;font-size:.85rem}
.toggle-switch{position:relative;width:44px;height:24px;cursor:pointer}
.toggle-switch input{opacity:0;width:0;height:0}
.toggle-slider{position:absolute;inset:0;background:#475569;border-radius:24px;transition:.3s}
.toggle-slider:before{content:'';position:absolute;height:18px;width:18px;left:3px;bottom:3px;background:#fff;border-radius:50%;transition:.3s}
input:checked+.toggle-slider{background:#3b82f6}
input:checked+.toggle-slider:before{transform:translateX(20px)}

/* Progress Bar */
.progress-bar-wrap{background:#1e293b;padding:8px 24px;display:flex;align-items:center;gap:12px}
.progress-bar-wrap span{color:#94a3b8;font-size:.8rem;white-space:nowrap}
.progress-bar{flex:1;height:8px;background:#334155;border-radius:4px;overflow:hidden}
.progress-fill{height:100%;background:linear-gradient(90deg,#3b82f6,#10b981);border-radius:4px;transition:width .5s}
.progress-label{color:#cbd5e1;font-size:.8rem;white-space:nowrap}

/* Nav Tabs */
.nav-tabs{display:flex;overflow-x:auto;background:#fff;border-bottom:3px solid #e2e8f0;scrollbar-width:none}
.nav-tabs::-webkit-scrollbar{display:none}
.nav-tab{flex:1;min-width:120px;padding:14px 8px;text-align:center;cursor:pointer;font-size:.8rem;font-weight:600;border:none;background:none;transition:all .2s;border-bottom:4px solid transparent;color:#64748b;white-space:nowrap}
.nav-tab:hover{background:#f8fafc}
.nav-tab.active{color:#fff;border-bottom-color:transparent}
.nav-tab[data-topic="pp"].active{background:#3b82f6}
.nav-tab[data-topic="ger"].active{background:#10b981}
.nav-tab[data-topic="inf"].active{background:#8b5cf6}
.nav-tab[data-topic="prep"].active{background:#f59e0b}
.nav-tab[data-topic="modal"].active{background:#ef4444}
.nav-tab[data-topic="pp"]:hover:not(.active){border-bottom:4px solid #3b82f6;color:#3b82f6}
.nav-tab[data-topic="ger"]:hover:not(.active){border-bottom:4px solid #10b981;color:#10b981}
.nav-tab[data-topic="inf"]:hover:not(.active){border-bottom:4px solid #8b5cf6;color:#8b5cf6}
.nav-tab[data-topic="prep"]:hover:not(.active){border-bottom:4px solid #f59e0b;color:#f59e0b}
.nav-tab[data-topic="modal"]:hover:not(.active){border-bottom:4px solid #ef4444;color:#ef4444}

/* Topic Sections */
.topic-section{display:none;padding:24px;max-width:960px;margin:0 auto}
.topic-section.active{display:block}

/* Cards */
.card{background:#fff;border-radius:12px;padding:24px;margin-bottom:20px;box-shadow:0 1px 3px rgba(0,0,0,.08)}
.card-title{font-size:1.1rem;font-weight:700;margin-bottom:16px;display:flex;align-items:center;gap:8px}
.card-title .badge{font-size:.7rem;padding:3px 8px;border-radius:20px;color:#fff;font-weight:600}
.badge-pp{background:#3b82f6}
.badge-ger{background:#10b981}
.badge-inf{background:#8b5cf6}
.badge-prep{background:#f59e0b}
.badge-modal{background:#ef4444}

/* Example sentences */
.example-block{background:#f8fafc;border-left:4px solid #e2e8f0;border-radius:0 8px 8px 0;padding:12px 16px;margin:8px 0}
.example-block.pp{border-left-color:#3b82f6}
.example-block.ger{border-left-color:#10b981}
.example-block.inf{border-left-color:#8b5cf6}
.example-block.prep{border-left-color:#f59e0b}
.example-block.modal{border-left-color:#ef4444}
.example-row{display:flex;align-items:center;gap:8px;padding:4px 0}
.example-en{font-weight:500;flex:1}
.example-jp{color:#64748b;font-size:.85rem;flex:1}
.tts-btn{background:none;border:1px solid #e2e8f0;border-radius:6px;padding:4px 8px;cursor:pointer;font-size:.85rem;transition:all .2s;flex-shrink:0}
.tts-btn:hover{background:#f1f5f9}

/* Subsection titles */
.sub-title{font-size:.95rem;font-weight:600;color:#475569;margin:16px 0 8px;padding-bottom:6px;border-bottom:2px solid #e2e8f0}

/* Table */
.irr-table{width:100%;border-collapse:collapse;font-size:.88rem}
.irr-table th{background:#f1f5f9;padding:8px 12px;text-align:left;font-weight:600;color:#475569}
.irr-table td{padding:8px 12px;border-bottom:1px solid #f1f5f9}
.irr-table tr:hover td{background:#f8fafc}
.irr-table td:nth-child(2),.irr-table td:nth-child(3){color:#3b82f6;font-weight:500}

/* Quiz sections */
.quiz-nav{display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap}
.quiz-tab-btn{padding:8px 16px;border-radius:8px;border:2px solid #e2e8f0;background:#fff;cursor:pointer;font-size:.85rem;font-weight:600;transition:all .2s;color:#475569}
.quiz-tab-btn.active-pp{background:#3b82f6;border-color:#3b82f6;color:#fff}
.quiz-tab-btn.active-ger{background:#10b981;border-color:#10b981;color:#fff}
.quiz-tab-btn.active-inf{background:#8b5cf6;border-color:#8b5cf6;color:#fff}
.quiz-tab-btn.active-prep{background:#f59e0b;border-color:#f59e0b;color:#fff}
.quiz-tab-btn.active-modal{background:#ef4444;border-color:#ef4444;color:#fff}

.quiz-panel{display:none}
.quiz-panel.active{display:block}

/* Quiz A */
.quiz-question{background:#f8fafc;border-radius:10px;padding:16px;margin-bottom:12px}
.quiz-question p{font-size:.95rem;margin-bottom:10px;font-weight:500;line-height:1.6}
.quiz-choices{display:flex;flex-wrap:wrap;gap:8px}
.choice-btn{padding:8px 16px;border-radius:8px;border:2px solid #e2e8f0;background:#fff;cursor:pointer;font-size:.85rem;font-weight:500;transition:all .2s}
.choice-btn:hover{border-color:#94a3b8}
.choice-btn.correct{background:#dcfce7;border-color:#10b981;color:#065f46}
.choice-btn.wrong{background:#fee2e2;border-color:#ef4444;color:#991b1b}
.choice-btn:disabled{cursor:not-allowed;opacity:.7}
.quiz-feedback{font-size:.85rem;margin-top:8px;padding:6px 10px;border-radius:6px;display:none}
.quiz-feedback.show{display:block}
.quiz-feedback.ok{background:#dcfce7;color:#065f46}
.quiz-feedback.ng{background:#fee2e2;color:#991b1b}

/* Quiz B - Scramble */
.scramble-question{background:#f8fafc;border-radius:10px;padding:16px;margin-bottom:16px}
.scramble-prompt{font-size:.9rem;color:#64748b;margin-bottom:8px}
.scramble-jp{font-weight:600;margin-bottom:12px}
.word-bank{display:flex;flex-wrap:wrap;gap:6px;min-height:40px;padding:8px;background:#fff;border:2px dashed #e2e8f0;border-radius:8px;margin-bottom:8px}
.answer-area{display:flex;flex-wrap:wrap;gap:6px;min-height:40px;padding:8px;background:#f0f9ff;border:2px dashed #93c5fd;border-radius:8px;margin-bottom:8px}
.word-chip{padding:6px 12px;background:#fff;border:2px solid #e2e8f0;border-radius:20px;cursor:pointer;font-size:.85rem;font-weight:500;transition:all .2s;user-select:none}
.word-chip:hover{border-color:#94a3b8;background:#f8fafc}
.word-chip.in-answer{background:#dbeafe;border-color:#3b82f6;color:#1e40af}
.scramble-check-btn{padding:8px 20px;border-radius:8px;border:none;background:#3b82f6;color:#fff;cursor:pointer;font-size:.85rem;font-weight:600;transition:all .2s}
.scramble-check-btn:hover{background:#2563eb}
.scramble-result{font-size:.85rem;margin-top:8px;padding:6px 10px;border-radius:6px;display:none}
.scramble-result.show{display:block}
.scramble-result.ok{background:#dcfce7;color:#065f46}
.scramble-result.ng{background:#fee2e2;color:#991b1b}
.scramble-reset-btn{padding:6px 14px;border-radius:8px;border:2px solid #e2e8f0;background:#fff;cursor:pointer;font-size:.8rem;margin-left:8px;transition:all .2s}
.scramble-reset-btn:hover{background:#f1f5f9}

/* Quiz C - Translation */
.trans-question{background:#f8fafc;border-radius:10px;padding:16px;margin-bottom:12px}
.trans-jp{font-size:1rem;font-weight:600;margin-bottom:10px;color:#1e293b}
.trans-show-btn{padding:8px 16px;border-radius:8px;border:2px solid #e2e8f0;background:#fff;cursor:pointer;font-size:.85rem;font-weight:500;transition:all .2s}
.trans-show-btn:hover{background:#f1f5f9}
.trans-answer{display:none;margin-top:10px;padding:10px 14px;background:#dcfce7;border-radius:8px;color:#065f46;font-weight:500}
.trans-answer.show{display:block}
.trans-audio-btn{margin-left:8px;padding:4px 8px;background:none;border:1px solid #10b981;border-radius:6px;cursor:pointer;font-size:.85rem;color:#065f46}

/* Score display */
.score-display{text-align:center;padding:12px;background:#f0f9ff;border-radius:10px;margin-bottom:16px;font-size:.9rem;color:#1e40af;font-weight:600}

/* Study Mode */
body.study-mode .quiz-section{display:none}
body.study-mode .study-mode-hint{display:block}
.study-mode-hint{display:none;background:#fef3c7;border-radius:8px;padding:12px 16px;color:#92400e;font-size:.85rem;margin-bottom:16px}

/* Verb list chips */
.verb-chips{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0}
.verb-chip{padding:6px 14px;background:#f1f5f9;border-radius:20px;font-size:.85rem;font-weight:500;color:#334155}

/* Phrase grid */
.phrase-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:8px;margin:8px 0}
.phrase-card{background:#f8fafc;border-radius:8px;padding:10px 14px;font-size:.85rem}
.phrase-card strong{display:block;color:#1e293b;font-weight:600;margin-bottom:2px}
.phrase-card span{color:#64748b}

/* Responsive */
@media(max-width:600px){
.nav-tab{font-size:.7rem;padding:12px 6px;min-width:70px}
header h1{font-size:1.3rem}
.topic-section{padding:12px}
.card{padding:16px}
}

/* Highlight keyword */
.kw{color:#3b82f6;font-weight:700}
.kw-ger{color:#10b981;font-weight:700}
.kw-inf{color:#8b5cf6;font-weight:700}
.kw-prep{color:#f59e0b;font-weight:700}
.kw-modal{color:#ef4444;font-weight:700}

/* Reset quiz button */
.reset-quiz-btn{padding:8px 18px;border-radius:8px;border:2px solid #e2e8f0;background:#fff;cursor:pointer;font-size:.85rem;font-weight:500;transition:all .2s;margin-top:12px}
.reset-quiz-btn:hover{background:#f1f5f9}

/* Section intro */
.section-intro{color:#64748b;font-size:.9rem;line-height:1.7;margin-bottom:16px}

/* Modal table */
.modal-table{width:100%;border-collapse:collapse;font-size:.85rem;margin:8px 0}
.modal-table th{background:#fef2f2;padding:8px 12px;text-align:left;font-weight:600;color:#991b1b}
.modal-table td{padding:8px 12px;border-bottom:1px solid #fef2f2;vertical-align:top}
.modal-table tr:hover td{background:#fff7f7}
</style>
</head>
<body>
<header>
  <h1>English Grammar Learning</h1>
  <p>è‹±èªæ–‡æ³•ã‚’æ¥½ã—ãå­¦ã¼ã† - Past Participle / Gerunds / To-Infinitives / Prepositions / Modal Verbs</p>
</header>

<div class="study-mode-bar">
  <label for="studyToggle">Study Mode (å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰)</label>
  <label class="toggle-switch">
    <input type="checkbox" id="studyToggle" onchange="toggleStudyMode(this)">
    <span class="toggle-slider"></span>
  </label>
</div>

<div class="progress-bar-wrap">
  <span>Progress:</span>
  <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width:0%"></div></div>
  <span class="progress-label" id="progressLabel">0 / 0 correct</span>
</div>

<div class="nav-tabs">
  <button class="nav-tab active" data-topic="pp" onclick="showTopic('pp',this)">Past Participle</button>
  <button class="nav-tab" data-topic="ger" onclick="showTopic('ger',this)">Gerunds</button>
  <button class="nav-tab" data-topic="inf" onclick="showTopic('inf',this)">To-Infinitives</button>
  <button class="nav-tab" data-topic="prep" onclick="showTopic('prep',this)">Prepositions</button>
  <button class="nav-tab" data-topic="modal" onclick="showTopic('modal',this)">Modal Verbs</button>
</div>

<!-- ========== PAST PARTICIPLE ========== -->
<div id="section-pp" class="topic-section active">
  <div class="card">
    <div class="card-title"><span class="badge badge-pp">PP</span>Past Participle - éå»åˆ†è©</div>
    <p class="section-intro">éå»åˆ†è©ï¼ˆPast Participleï¼‰ã¯å‹•è©ã®ç¬¬3å½¢ã§ã™ã€‚å®Œäº†å½¢ãƒ»å—å‹•æ…‹ãƒ»å½¢å®¹è©ã¨ã—ã¦ä½¿ã‚ã‚Œã¾ã™ã€‚</p>

    <div class="sub-title">1. å®Œäº†å½¢ (Perfect Tenses)</div>
    <div class="example-block pp">
      <div class="example-row"><span class="example-en">I have <span class="kw">eaten</span> lunch.</span><span class="example-jp">æ˜¼é£Ÿã‚’é£Ÿã¹ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('I have eaten lunch.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She has <span class="kw">gone</span> to the store.</span><span class="example-jp">å½¼å¥³ã¯ãŠåº—ã«è¡Œãã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('She has gone to the store.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">We have <span class="kw">finished</span> our homework.</span><span class="example-jp">ç§ãŸã¡ã¯å®¿é¡Œã‚’çµ‚ãˆã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('We have finished our homework.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He has <span class="kw">broken</span> the window.</span><span class="example-jp">å½¼ã¯çª“ã‚’å£Šã—ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('He has broken the window.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">They have <span class="kw">made</span> a decision.</span><span class="example-jp">å½¼ã‚‰ã¯æ±ºæ–­ã‚’ä¸‹ã—ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('They have made a decision.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">2. å—å‹•æ…‹ (Passive Voice)</div>
    <div class="example-block pp">
      <div class="example-row"><span class="example-en">The book was <span class="kw">written</span> by Hemingway.</span><span class="example-jp">ãã®æœ¬ã¯ãƒ˜ãƒŸãƒ³ã‚°ã‚¦ã‚§ã‚¤ã«ã‚ˆã£ã¦æ›¸ã‹ã‚Œã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('The book was written by Hemingway.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">The cake was <span class="kw">eaten</span> by the children.</span><span class="example-jp">ã‚±ãƒ¼ã‚­ã¯å­ä¾›ãŸã¡ã«é£Ÿã¹ã‚‰ã‚Œã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('The cake was eaten by the children.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">The window was <span class="kw">broken</span> by the ball.</span><span class="example-jp">çª“ã¯ãƒœãƒ¼ãƒ«ã§å‰²ã‚‰ã‚Œã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('The window was broken by the ball.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">The letter was <span class="kw">sent</span> yesterday.</span><span class="example-jp">æ‰‹ç´™ã¯æ˜¨æ—¥é€ã‚‰ã‚Œã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('The letter was sent yesterday.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">The house was <span class="kw">built</span> in 1990.</span><span class="example-jp">ãã®å®¶ã¯1990å¹´ã«å»ºã¦ã‚‰ã‚Œã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('The house was built in 1990.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">3. å½¢å®¹è©ã¨ã—ã¦ (As Adjective)</div>
    <div class="example-block pp">
      <div class="example-row"><span class="example-en">a <span class="kw">broken</span> window</span><span class="example-jp">å‰²ã‚ŒãŸçª“</span><button class="tts-btn" onclick="speak('a broken window')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">a <span class="kw">used</span> car</span><span class="example-jp">ä¸­å¤è»Š</span><button class="tts-btn" onclick="speak('a used car')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">a <span class="kw">written</span> letter</span><span class="example-jp">æ›¸ã‹ã‚ŒãŸæ‰‹ç´™</span><button class="tts-btn" onclick="speak('a written letter')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">a <span class="kw">bored</span> student</span><span class="example-jp">é€€å±ˆã—ãŸå­¦ç”Ÿ</span><button class="tts-btn" onclick="speak('a bored student')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">an <span class="kw">excited</span> crowd</span><span class="example-jp">èˆˆå¥®ã—ãŸç¾¤è¡†</span><button class="tts-btn" onclick="speak('an excited crowd')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">4. get + éå»åˆ†è© (get + Past Participle)</div>
    <div class="example-block pp">
      <div class="example-row"><span class="example-en">get <span class="kw">tired</span></span><span class="example-jp">ç–²ã‚Œã‚‹</span><button class="tts-btn" onclick="speak('get tired')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">get <span class="kw">married</span></span><span class="example-jp">çµå©šã™ã‚‹</span><button class="tts-btn" onclick="speak('get married')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">get <span class="kw">excited</span></span><span class="example-jp">èˆˆå¥®ã™ã‚‹</span><button class="tts-btn" onclick="speak('get excited')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">get <span class="kw">lost</span></span><span class="example-jp">è¿·å­ã«ãªã‚‹</span><button class="tts-btn" onclick="speak('get lost')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">get <span class="kw">dressed</span></span><span class="example-jp">æœã‚’ç€ã‚‹</span><button class="tts-btn" onclick="speak('get dressed')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">5. ä¸è¦å‰‡å‹•è©ä¸€è¦§ (Irregular Verbs)</div>
    <table class="irr-table">
      <tr><th>Base Form</th><th>Past Tense</th><th>Past Participle</th><th></th></tr>
      <tr><td>go</td><td>went</td><td>gone</td><td><button class="tts-btn" onclick="speak('go went gone')">ğŸ”Š</button></td></tr>
      <tr><td>write</td><td>wrote</td><td>written</td><td><button class="tts-btn" onclick="speak('write wrote written')">ğŸ”Š</button></td></tr>
      <tr><td>eat</td><td>ate</td><td>eaten</td><td><button class="tts-btn" onclick="speak('eat ate eaten')">ğŸ”Š</button></td></tr>
      <tr><td>break</td><td>broke</td><td>broken</td><td><button class="tts-btn" onclick="speak('break broke broken')">ğŸ”Š</button></td></tr>
      <tr><td>make</td><td>made</td><td>made</td><td><button class="tts-btn" onclick="speak('make made made')">ğŸ”Š</button></td></tr>
      <tr><td>take</td><td>took</td><td>taken</td><td><button class="tts-btn" onclick="speak('take took taken')">ğŸ”Š</button></td></tr>
      <tr><td>give</td><td>gave</td><td>given</td><td><button class="tts-btn" onclick="speak('give gave given')">ğŸ”Š</button></td></tr>
      <tr><td>know</td><td>knew</td><td>known</td><td><button class="tts-btn" onclick="speak('know knew known')">ğŸ”Š</button></td></tr>
      <tr><td>see</td><td>saw</td><td>seen</td><td><button class="tts-btn" onclick="speak('see saw seen')">ğŸ”Š</button></td></tr>
      <tr><td>come</td><td>came</td><td>come</td><td><button class="tts-btn" onclick="speak('come came come')">ğŸ”Š</button></td></tr>
      <tr><td>run</td><td>ran</td><td>run</td><td><button class="tts-btn" onclick="speak('run ran run')">ğŸ”Š</button></td></tr>
      <tr><td>speak</td><td>spoke</td><td>spoken</td><td><button class="tts-btn" onclick="speak('speak spoke spoken')">ğŸ”Š</button></td></tr>
      <tr><td>choose</td><td>chose</td><td>chosen</td><td><button class="tts-btn" onclick="speak('choose chose chosen')">ğŸ”Š</button></td></tr>
      <tr><td>draw</td><td>drew</td><td>drawn</td><td><button class="tts-btn" onclick="speak('draw drew drawn')">ğŸ”Š</button></td></tr>
      <tr><td>forget</td><td>forgot</td><td>forgotten</td><td><button class="tts-btn" onclick="speak('forget forgot forgotten')">ğŸ”Š</button></td></tr>
      <tr><td>grow</td><td>grew</td><td>grown</td><td><button class="tts-btn" onclick="speak('grow grew grown')">ğŸ”Š</button></td></tr>
      <tr><td>hide</td><td>hid</td><td>hidden</td><td><button class="tts-btn" onclick="speak('hide hid hidden')">ğŸ”Š</button></td></tr>
      <tr><td>steal</td><td>stole</td><td>stolen</td><td><button class="tts-btn" onclick="speak('steal stole stolen')">ğŸ”Š</button></td></tr>
      <tr><td>throw</td><td>threw</td><td>thrown</td><td><button class="tts-btn" onclick="speak('throw threw thrown')">ğŸ”Š</button></td></tr>
      <tr><td>wear</td><td>wore</td><td>worn</td><td><button class="tts-btn" onclick="speak('wear wore worn')">ğŸ”Š</button></td></tr>
    </table>
  </div>

  <!-- PP QUIZ -->
  <div class="card quiz-section">
    <div class="card-title"><span class="badge badge-pp">Quiz</span>Practice Quizzes</div>
    <div class="study-mode-hint">Study Mode ON: ã‚¯ã‚¤ã‚ºã¯éè¡¨ç¤ºã§ã™ã€‚å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ•ã«ã™ã‚‹ã¨ã‚¯ã‚¤ã‚ºãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>
    <div class="quiz-nav">
      <button class="quiz-tab-btn active-pp" onclick="showQuiz('pp','A',this)">Type A: Fill-in-Blank</button>
      <button class="quiz-tab-btn" onclick="showQuiz('pp','B',this)">Type B: Scramble</button>
      <button class="quiz-tab-btn" onclick="showQuiz('pp','C',this)">Type C: Translation</button>
    </div>
    <div class="score-display" id="score-pp">Score: 0 / 0</div>

    <!-- PP Quiz A -->
    <div id="quiz-pp-A" class="quiz-panel active">
      <div id="pp-A-questions"></div>
      <button class="reset-quiz-btn" onclick="resetQuizA('pp')">Reset Quiz</button>
    </div>

    <!-- PP Quiz B -->
    <div id="quiz-pp-B" class="quiz-panel">
      <div id="pp-B-scrambles"></div>
    </div>

    <!-- PP Quiz C -->
    <div id="quiz-pp-C" class="quiz-panel">
      <div id="pp-C-translations"></div>
    </div>
  </div>
</div>

<!-- ========== GERUNDS ========== -->
<div id="section-ger" class="topic-section">
  <div class="card">
    <div class="card-title"><span class="badge badge-ger">GER</span>Gerunds - å‹•åè©</div>
    <p class="section-intro">å‹•åè©ï¼ˆGerundï¼‰ã¯å‹•è©ã« -ing ã‚’ã¤ã‘ã¦åè©ã®ã‚ˆã†ã«ä½¿ã†å½¢ã§ã™ã€‚ä¸»èªãƒ»ç›®çš„èªãƒ»å‰ç½®è©ã®å¾Œãªã©ã§ä½¿ã‚ã‚Œã¾ã™ã€‚</p>

    <div class="sub-title">1. ä¸»èªã¨ã—ã¦ (As Subject)</div>
    <div class="example-block ger">
      <div class="example-row"><span class="example-en"><span class="kw-ger">Swimming</span> is fun.</span><span class="example-jp">æ°´æ³³ã¯æ¥½ã—ã„ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('Swimming is fun.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en"><span class="kw-ger">Reading books</span> is important.</span><span class="example-jp">æœ¬ã‚’èª­ã‚€ã“ã¨ã¯å¤§åˆ‡ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('Reading books is important.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en"><span class="kw-ger">Cooking meals</span> takes time.</span><span class="example-jp">é£Ÿäº‹ã‚’ä½œã‚‹ã“ã¨ã¯æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('Cooking meals takes time.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en"><span class="kw-ger">Learning English</span> is exciting.</span><span class="example-jp">è‹±èªã‚’å­¦ã¶ã“ã¨ã¯ã‚ãã‚ãã—ã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('Learning English is exciting.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en"><span class="kw-ger">Running every day</span> keeps you healthy.</span><span class="example-jp">æ¯æ—¥èµ°ã‚‹ã“ã¨ã¯å¥åº·ã‚’ä¿ã¡ã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('Running every day keeps you healthy.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">2. ç›®çš„èªã¨ã—ã¦ (As Object)</div>
    <div class="example-block ger">
      <div class="example-row"><span class="example-en">I enjoy <span class="kw-ger">reading</span>.</span><span class="example-jp">ç§ã¯èª­æ›¸ã‚’æ¥½ã—ã¿ã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('I enjoy reading.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She finished <span class="kw-ger">cooking</span>.</span><span class="example-jp">å½¼å¥³ã¯æ–™ç†ã‚’çµ‚ãˆã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('She finished cooking.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He avoided <span class="kw-ger">talking</span> to her.</span><span class="example-jp">å½¼ã¯å½¼å¥³ã¨è©±ã™ã“ã¨ã‚’é¿ã‘ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('He avoided talking to her.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">We consider <span class="kw-ger">moving</span> to Tokyo.</span><span class="example-jp">ç§ãŸã¡ã¯æ±äº¬ã¸ã®å¼•è¶Šã—ã‚’æ¤œè¨ã—ã¦ã„ã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('We consider moving to Tokyo.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">They suggest <span class="kw-ger">waiting</span> here.</span><span class="example-jp">å½¼ã‚‰ã¯ã“ã“ã§å¾…ã¤ã“ã¨ã‚’ææ¡ˆã—ã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('They suggest waiting here.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">3. å‰ç½®è©ã®å¾Œ (After Prepositions)</div>
    <div class="example-block ger">
      <div class="example-row"><span class="example-en">She is good at <span class="kw-ger">cooking</span>.</span><span class="example-jp">å½¼å¥³ã¯æ–™ç†ãŒå¾—æ„ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('She is good at cooking.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He is interested in <span class="kw-ger">learning</span> Japanese.</span><span class="example-jp">å½¼ã¯æ—¥æœ¬èªå­¦ç¿’ã«èˆˆå‘³ãŒã‚ã‚Šã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('He is interested in learning Japanese.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">We are tired of <span class="kw-ger">waiting</span>.</span><span class="example-jp">ç§ãŸã¡ã¯å¾…ã¡ããŸã³ã‚Œã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('We are tired of waiting.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">I am afraid of <span class="kw-ger">flying</span>.</span><span class="example-jp">ç§ã¯é£›è¡Œæ©ŸãŒæ€–ã„ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('I am afraid of flying.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She is responsible for <span class="kw-ger">managing</span> the team.</span><span class="example-jp">å½¼å¥³ã¯ãƒãƒ¼ãƒ ç®¡ç†ã®è²¬ä»»ãŒã‚ã‚Šã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('She is responsible for managing the team.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">4. å‹•åè©ã‚’å–ã‚‹å‹•è© (Verbs + Gerund)</div>
    <div class="verb-chips">
      <span class="verb-chip">enjoy</span><span class="verb-chip">finish</span><span class="verb-chip">avoid</span>
      <span class="verb-chip">consider</span><span class="verb-chip">suggest</span><span class="verb-chip">practice</span>
      <span class="verb-chip">mind</span><span class="verb-chip">keep</span><span class="verb-chip">admit</span><span class="verb-chip">deny</span>
    </div>
  </div>

  <!-- GER QUIZ -->
  <div class="card quiz-section">
    <div class="card-title"><span class="badge badge-ger">Quiz</span>Practice Quizzes</div>
    <div class="study-mode-hint">Study Mode ON: ã‚¯ã‚¤ã‚ºã¯éè¡¨ç¤ºã§ã™ã€‚</div>
    <div class="quiz-nav">
      <button class="quiz-tab-btn active-ger" onclick="showQuiz('ger','A',this)">Type A: Fill-in-Blank</button>
      <button class="quiz-tab-btn" onclick="showQuiz('ger','B',this)">Type B: Scramble</button>
      <button class="quiz-tab-btn" onclick="showQuiz('ger','C',this)">Type C: Translation</button>
    </div>
    <div class="score-display" id="score-ger">Score: 0 / 0</div>
    <div id="quiz-ger-A" class="quiz-panel active"><div id="ger-A-questions"></div><button class="reset-quiz-btn" onclick="resetQuizA('ger')">Reset Quiz</button></div>
    <div id="quiz-ger-B" class="quiz-panel"><div id="ger-B-scrambles"></div></div>
    <div id="quiz-ger-C" class="quiz-panel"><div id="ger-C-translations"></div></div>
  </div>
</div>

<!-- ========== TO-INFINITIVES ========== -->
<div id="section-inf" class="topic-section">
  <div class="card">
    <div class="card-title"><span class="badge badge-inf">INF</span>To-Infinitives - toä¸å®šè©</div>
    <p class="section-intro">toä¸å®šè©ï¼ˆTo-Infinitiveï¼‰ã¯ã€Œto + å‹•è©ã®åŸå½¢ã€ã®å½¢ã§ã™ã€‚åè©ãƒ»å½¢å®¹è©ãƒ»å‰¯è©ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚</p>

    <div class="sub-title">1. å‹•è©ã®å¾Œ (After Verbs)</div>
    <div class="example-block inf">
      <div class="example-row"><span class="example-en">I want <span class="kw-inf">to go</span> to Paris.</span><span class="example-jp">ç§ã¯ãƒ‘ãƒªã«è¡ŒããŸã„ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('I want to go to Paris.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She needs <span class="kw-inf">to study</span> more.</span><span class="example-jp">å½¼å¥³ã¯ã‚‚ã£ã¨å‹‰å¼·ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('She needs to study more.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He hopes <span class="kw-inf">to visit</span> Japan.</span><span class="example-jp">å½¼ã¯æ—¥æœ¬ã‚’è¨ªã‚Œã‚‹ã“ã¨ã‚’æœ›ã‚“ã§ã„ã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('He hopes to visit Japan.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">We plan <span class="kw-inf">to travel</span> this summer.</span><span class="example-jp">ç§ãŸã¡ã¯ä»Šå¤æ—…è¡Œã™ã‚‹äºˆå®šã§ã™ã€‚</span><button class="tts-btn" onclick="speak('We plan to travel this summer.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She decided <span class="kw-inf">to leave</span> early.</span><span class="example-jp">å½¼å¥³ã¯æ—©ãå‡ºç™ºã™ã‚‹ã“ã¨ã«æ±ºã‚ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('She decided to leave early.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He promised <span class="kw-inf">to help</span> me.</span><span class="example-jp">å½¼ã¯ç§ã‚’åŠ©ã‘ã‚‹ã¨ç´„æŸã—ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('He promised to help me.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">They agreed <span class="kw-inf">to meet</span> at noon.</span><span class="example-jp">å½¼ã‚‰ã¯æ­£åˆã«ä¼šã†ã“ã¨ã«åŒæ„ã—ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('They agreed to meet at noon.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She refused <span class="kw-inf">to answer</span>.</span><span class="example-jp">å½¼å¥³ã¯ç­”ãˆã‚‹ã“ã¨ã‚’æ‹’å¦ã—ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('She refused to answer.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">2. ç›®çš„ã‚’è¡¨ã™ (Purpose)</div>
    <div class="example-block inf">
      <div class="example-row"><span class="example-en">I went to the store <span class="kw-inf">to buy</span> milk.</span><span class="example-jp">ç‰›ä¹³ã‚’è²·ã†ãŸã‚ã«ãŠåº—ã«è¡Œãã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('I went to the store to buy milk.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She studied hard <span class="kw-inf">to pass</span> the exam.</span><span class="example-jp">è©¦é¨“ã«åˆæ ¼ã™ã‚‹ãŸã‚ã«ä¸€ç”Ÿæ‡¸å‘½å‹‰å¼·ã—ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('She studied hard to pass the exam.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He saved money <span class="kw-inf">to buy</span> a car.</span><span class="example-jp">è»Šã‚’è²·ã†ãŸã‚ã«ãŠé‡‘ã‚’è²¯ã‚ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('He saved money to buy a car.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">We came early <span class="kw-inf">to get</span> good seats.</span><span class="example-jp">è‰¯ã„å¸­ã‚’å–ã‚‹ãŸã‚ã«æ—©ãæ¥ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('We came early to get good seats.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">They practiced daily <span class="kw-inf">to improve</span> their skills.</span><span class="example-jp">ã‚¹ã‚­ãƒ«ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã«æ¯æ—¥ç·´ç¿’ã—ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('They practiced daily to improve their skills.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">3. å½¢å®¹è©ã®å¾Œ (After Adjectives)</div>
    <div class="example-block inf">
      <div class="example-row"><span class="example-en">I am happy <span class="kw-inf">to hear</span> that.</span><span class="example-jp">ãã‚Œã‚’èã„ã¦å¬‰ã—ã„ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('I am happy to hear that.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">It is easy <span class="kw-inf">to understand</span>.</span><span class="example-jp">ç†è§£ã™ã‚‹ã®ã¯ç°¡å˜ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('It is easy to understand.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">It is important <span class="kw-inf">to remember</span> this.</span><span class="example-jp">ã“ã‚Œã‚’è¦šãˆã‚‹ã“ã¨ã¯å¤§åˆ‡ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('It is important to remember this.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">It is difficult <span class="kw-inf">to explain</span>.</span><span class="example-jp">èª¬æ˜ã™ã‚‹ã®ã¯é›£ã—ã„ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('It is difficult to explain.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She was excited <span class="kw-inf">to meet</span> the singer.</span><span class="example-jp">å½¼å¥³ã¯ãã®æ­Œæ‰‹ã«ä¼šãˆã¦èˆˆå¥®ã—ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('She was excited to meet the singer.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">4. It is + å½¢å®¹è© + to (It is + Adj + to-inf)</div>
    <div class="example-block inf">
      <div class="example-row"><span class="example-en">It is important <span class="kw-inf">to study</span> every day.</span><span class="example-jp">æ¯æ—¥å‹‰å¼·ã™ã‚‹ã“ã¨ã¯å¤§åˆ‡ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('It is important to study every day.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">It is easy <span class="kw-inf">to learn</span> new words.</span><span class="example-jp">æ–°ã—ã„å˜èªã‚’è¦šãˆã‚‹ã®ã¯ç°¡å˜ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('It is easy to learn new words.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">It is difficult <span class="kw-inf">to understand</span> grammar.</span><span class="example-jp">æ–‡æ³•ã‚’ç†è§£ã™ã‚‹ã®ã¯é›£ã—ã„ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('It is difficult to understand grammar.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">It is necessary <span class="kw-inf">to practice</span> speaking.</span><span class="example-jp">ä¼šè©±ã‚’ç·´ç¿’ã™ã‚‹ã“ã¨ã¯å¿…è¦ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('It is necessary to practice speaking.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">It is fun <span class="kw-inf">to travel</span> abroad.</span><span class="example-jp">æµ·å¤–æ—…è¡Œã¯æ¥½ã—ã„ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('It is fun to travel abroad.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">5. too + å½¢å®¹è© + to (Too + Adj + to-inf)</div>
    <div class="example-block inf">
      <div class="example-row"><span class="example-en">I am too tired <span class="kw-inf">to work</span>.</span><span class="example-jp">ç–²ã‚Œã™ãã¦ä»•äº‹ã§ãã¾ã›ã‚“ã€‚</span><button class="tts-btn" onclick="speak('I am too tired to work.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She is too young <span class="kw-inf">to drive</span>.</span><span class="example-jp">å½¼å¥³ã¯è‹¥ã™ãã¦é‹è»¢ã§ãã¾ã›ã‚“ã€‚</span><button class="tts-btn" onclick="speak('She is too young to drive.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He is too busy <span class="kw-inf">to talk</span>.</span><span class="example-jp">å½¼ã¯å¿™ã—ã™ãã¦è©±ã›ã¾ã›ã‚“ã€‚</span><button class="tts-btn" onclick="speak('He is too busy to talk.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">It is too heavy <span class="kw-inf">to lift</span>.</span><span class="example-jp">é‡ã™ãã¦æŒã¡ä¸Šã’ã‚‰ã‚Œã¾ã›ã‚“ã€‚</span><button class="tts-btn" onclick="speak('It is too heavy to lift.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">The soup is too hot <span class="kw-inf">to eat</span>.</span><span class="example-jp">ã‚¹ãƒ¼ãƒ—ã¯ç†±ã™ãã¦é£Ÿã¹ã‚‰ã‚Œã¾ã›ã‚“ã€‚</span><button class="tts-btn" onclick="speak('The soup is too hot to eat.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">6. å½¢å®¹è© + enough + to (Adj + enough + to-inf)</div>
    <div class="example-block inf">
      <div class="example-row"><span class="example-en">He is strong enough <span class="kw-inf">to lift</span> it.</span><span class="example-jp">å½¼ã¯ãã‚Œã‚’æŒã¡ä¸Šã’ã‚‹ã»ã©å¼·ã„ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('He is strong enough to lift it.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She is old enough <span class="kw-inf">to vote</span>.</span><span class="example-jp">å½¼å¥³ã¯æŠ•ç¥¨ã§ãã‚‹å¹´é½¢ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('She is old enough to vote.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He runs fast enough <span class="kw-inf">to win</span>.</span><span class="example-jp">å½¼ã¯å‹ã¦ã‚‹ã»ã©é€Ÿãèµ°ã‚Šã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('He runs fast enough to win.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">Your score is good enough <span class="kw-inf">to pass</span>.</span><span class="example-jp">ã‚ãªãŸã®ç‚¹æ•°ã¯åˆæ ¼ã§ãã‚‹æ°´æº–ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('Your score is good enough to pass.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She is tall enough <span class="kw-inf">to reach</span> the shelf.</span><span class="example-jp">å½¼å¥³ã¯æ£šã«å±Šãã»ã©èƒŒãŒé«˜ã„ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('She is tall enough to reach the shelf.')">ğŸ”Š</button></div>
    </div>
  </div>

  <!-- INF QUIZ -->
  <div class="card quiz-section">
    <div class="card-title"><span class="badge badge-inf">Quiz</span>Practice Quizzes</div>
    <div class="study-mode-hint">Study Mode ON: ã‚¯ã‚¤ã‚ºã¯éè¡¨ç¤ºã§ã™ã€‚</div>
    <div class="quiz-nav">
      <button class="quiz-tab-btn active-inf" onclick="showQuiz('inf','A',this)">Type A: Fill-in-Blank</button>
      <button class="quiz-tab-btn" onclick="showQuiz('inf','B',this)">Type B: Scramble</button>
      <button class="quiz-tab-btn" onclick="showQuiz('inf','C',this)">Type C: Translation</button>
    </div>
    <div class="score-display" id="score-inf">Score: 0 / 0</div>
    <div id="quiz-inf-A" class="quiz-panel active"><div id="inf-A-questions"></div><button class="reset-quiz-btn" onclick="resetQuizA('inf')">Reset Quiz</button></div>
    <div id="quiz-inf-B" class="quiz-panel"><div id="inf-B-scrambles"></div></div>
    <div id="quiz-inf-C" class="quiz-panel"><div id="inf-C-translations"></div></div>
  </div>
</div>

<!-- ========== PREPOSITIONS ========== -->
<div id="section-prep" class="topic-section">
  <div class="card">
    <div class="card-title"><span class="badge badge-prep">PREP</span>Prepositions - å‰ç½®è©</div>
    <p class="section-intro">å‰ç½®è©ï¼ˆPrepositionï¼‰ã¯æ™‚é–“ãƒ»å ´æ‰€ãƒ»æ–¹å‘ãªã©ã‚’è¡¨ã™èªã§ã™ã€‚at / on / in ã®ä½¿ã„åˆ†ã‘ãŒç‰¹ã«é‡è¦ã§ã™ã€‚</p>

    <div class="sub-title">1. æ™‚é–“ã®å‰ç½®è© (Time: at / on / in)</div>
    <div class="phrase-grid">
      <div class="phrase-card"><strong><span class="kw-prep">at</span> 3pm</strong><span>åˆå¾Œ3æ™‚ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">at</span> night</strong><span>å¤œã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">at</span> noon</strong><span>æ­£åˆã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">at</span> midnight</strong><span>æ·±å¤œ0æ™‚ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">at</span> the weekend</strong><span>é€±æœ«ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">on</span> Monday</strong><span>æœˆæ›œæ—¥ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">on</span> July 4th</strong><span>7æœˆ4æ—¥ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">on</span> my birthday</strong><span>èª•ç”Ÿæ—¥ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">on</span> weekdays</strong><span>å¹³æ—¥ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">on</span> time</strong><span>æ™‚é–“é€šã‚Šã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">in</span> 2024</strong><span>2024å¹´ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">in</span> winter</strong><span>å†¬ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">in</span> the morning</strong><span>æœã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">in</span> January</strong><span>1æœˆã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">in</span> the future</strong><span>å°†æ¥ã«</span></div>
    </div>

    <div class="example-block prep">
      <div class="example-row"><span class="example-en">The meeting is <span class="kw-prep">at</span> 3pm.</span><span class="example-jp">ä¼šè­°ã¯åˆå¾Œ3æ™‚ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('The meeting is at 3pm.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She was born <span class="kw-prep">on</span> July 4th.</span><span class="example-jp">å½¼å¥³ã¯7æœˆ4æ—¥ã«ç”Ÿã¾ã‚Œã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('She was born on July 4th.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">I will see you <span class="kw-prep">in</span> the morning.</span><span class="example-jp">æœã«ãŠä¼šã„ã—ã¾ã—ã‚‡ã†ã€‚</span><button class="tts-btn" onclick="speak('I will see you in the morning.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">2. å ´æ‰€ã®å‰ç½®è© (Place: at / on / in)</div>
    <div class="phrase-grid">
      <div class="phrase-card"><strong><span class="kw-prep">at</span> home</strong><span>å®¶ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">at</span> school</strong><span>å­¦æ ¡ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">at</span> work</strong><span>è·å ´ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">at</span> the station</strong><span>é§…ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">on</span> the table</strong><span>ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸Šã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">on</span> the wall</strong><span>å£ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">on</span> the floor</strong><span>åºŠã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">on</span> the left</strong><span>å·¦å´ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">in</span> the box</strong><span>ç®±ã®ä¸­ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">in</span> Japan</strong><span>æ—¥æœ¬ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">in</span> the room</strong><span>éƒ¨å±‹ã®ä¸­ã«</span></div>
      <div class="phrase-card"><strong><span class="kw-prep">in</span> the car</strong><span>è»Šã®ä¸­ã«</span></div>
    </div>

    <div class="example-block prep">
      <div class="example-row"><span class="example-en">She is <span class="kw-prep">at</span> school now.</span><span class="example-jp">å½¼å¥³ã¯ä»Šå­¦æ ¡ã«ã„ã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('She is at school now.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">The book is <span class="kw-prep">on</span> the table.</span><span class="example-jp">æœ¬ã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸Šã«ã‚ã‚Šã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('The book is on the table.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He lives <span class="kw-prep">in</span> Japan.</span><span class="example-jp">å½¼ã¯æ—¥æœ¬ã«ä½ã‚“ã§ã„ã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('He lives in Japan.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">3. ç§»å‹•ã®å‰ç½®è© (Movement)</div>
    <div class="example-block prep">
      <div class="example-row"><span class="example-en">She went <span class="kw-prep">to</span> school.</span><span class="example-jp">å½¼å¥³ã¯å­¦æ ¡ã¸è¡Œãã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('She went to school.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He came <span class="kw-prep">from</span> home.</span><span class="example-jp">å½¼ã¯å®¶ã‹ã‚‰æ¥ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('He came from home.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She walked <span class="kw-prep">into</span> the room.</span><span class="example-jp">å½¼å¥³ã¯éƒ¨å±‹ã«æ­©ã„ã¦å…¥ã‚Šã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('She walked into the room.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He ran <span class="kw-prep">out of</span> the building.</span><span class="example-jp">å½¼ã¯å»ºç‰©ã‹ã‚‰èµ°ã‚Šå‡ºã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('He ran out of the building.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">We walked <span class="kw-prep">through</span> the park.</span><span class="example-jp">ç§ãŸã¡ã¯å…¬åœ’ã‚’é€šã‚ŠæŠœã‘ã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('We walked through the park.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She swam <span class="kw-prep">across</span> the river.</span><span class="example-jp">å½¼å¥³ã¯å·ã‚’æ³³ã„ã§æ¸¡ã‚Šã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('She swam across the river.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">We walked <span class="kw-prep">along</span> the street.</span><span class="example-jp">ç§ãŸã¡ã¯é€šã‚Šã«æ²¿ã£ã¦æ­©ãã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('We walked along the street.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He ran <span class="kw-prep">toward</span> the exit.</span><span class="example-jp">å½¼ã¯å‡ºå£ã«å‘ã‹ã£ã¦èµ°ã‚Šã¾ã—ãŸã€‚</span><button class="tts-btn" onclick="speak('He ran toward the exit.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">4. ã‚ˆãä½¿ã†ç†Ÿèª (Common Phrases)</div>
    <div class="phrase-grid">
      <div class="phrase-card"><strong>interested <span class="kw-prep">in</span></strong><span>ã€œã«èˆˆå‘³ãŒã‚ã‚‹</span></div>
      <div class="phrase-card"><strong>good <span class="kw-prep">at</span></strong><span>ã€œãŒå¾—æ„</span></div>
      <div class="phrase-card"><strong>afraid <span class="kw-prep">of</span></strong><span>ã€œãŒæ€–ã„</span></div>
      <div class="phrase-card"><strong>responsible <span class="kw-prep">for</span></strong><span>ã€œã®è²¬ä»»ãŒã‚ã‚‹</span></div>
      <div class="phrase-card"><strong>depend <span class="kw-prep">on</span></strong><span>ã€œã«ä¾å­˜ã™ã‚‹</span></div>
      <div class="phrase-card"><strong>look forward <span class="kw-prep">to</span></strong><span>ã€œã‚’æ¥½ã—ã¿ã«ã™ã‚‹</span></div>
      <div class="phrase-card"><strong>tired <span class="kw-prep">of</span></strong><span>ã€œã«é£½ãé£½ãã—ãŸ</span></div>
      <div class="phrase-card"><strong>excited <span class="kw-prep">about</span></strong><span>ã€œã«ã‚ãã‚ãã™ã‚‹</span></div>
    </div>
    <div class="example-block prep">
      <div class="example-row"><span class="example-en">I am interested <span class="kw-prep">in</span> music.</span><span class="example-jp">ç§ã¯éŸ³æ¥½ã«èˆˆå‘³ãŒã‚ã‚Šã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('I am interested in music.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She is good <span class="kw-prep">at</span> math.</span><span class="example-jp">å½¼å¥³ã¯æ•°å­¦ãŒå¾—æ„ã§ã™ã€‚</span><button class="tts-btn" onclick="speak('She is good at math.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">I look forward <span class="kw-prep">to</span> meeting you.</span><span class="example-jp">ãŠä¼šã„ã™ã‚‹ã®ã‚’æ¥½ã—ã¿ã«ã—ã¦ã„ã¾ã™ã€‚</span><button class="tts-btn" onclick="speak('I look forward to meeting you.')">ğŸ”Š</button></div>
    </div>
  </div>

  <!-- PREP QUIZ -->
  <div class="card quiz-section">
    <div class="card-title"><span class="badge badge-prep">Quiz</span>Practice Quizzes</div>
    <div class="study-mode-hint">Study Mode ON: ã‚¯ã‚¤ã‚ºã¯éè¡¨ç¤ºã§ã™ã€‚</div>
    <div class="quiz-nav">
      <button class="quiz-tab-btn active-prep" onclick="showQuiz('prep','A',this)">Type A: Fill-in-Blank</button>
      <button class="quiz-tab-btn" onclick="showQuiz('prep','B',this)">Type B: Scramble</button>
      <button class="quiz-tab-btn" onclick="showQuiz('prep','C',this)">Type C: Translation</button>
    </div>
    <div class="score-display" id="score-prep">Score: 0 / 0</div>
    <div id="quiz-prep-A" class="quiz-panel active"><div id="prep-A-questions"></div><button class="reset-quiz-btn" onclick="resetQuizA('prep')">Reset Quiz</button></div>
    <div id="quiz-prep-B" class="quiz-panel"><div id="prep-B-scrambles"></div></div>
    <div id="quiz-prep-C" class="quiz-panel"><div id="prep-C-translations"></div></div>
  </div>
</div>

<!-- ========== MODAL VERBS ========== -->
<div id="section-modal" class="topic-section">
  <div class="card">
    <div class="card-title"><span class="badge badge-modal">MOD</span>Modal Verbs - åŠ©å‹•è©</div>
    <p class="section-intro">åŠ©å‹•è©ï¼ˆModal Verbsï¼‰ã¯å‹•è©ã®å‰ã«ç½®ã„ã¦ã€å¯èƒ½ãƒ»è¨±å¯ãƒ»ç¾©å‹™ãƒ»æ¨é‡ãªã©ã®æ„å‘³ã‚’åŠ ãˆã¾ã™ã€‚</p>

    <div class="sub-title">1. can / could (ã§ãã‚‹ãƒ»è¨±å¯ãƒ»ä¾é ¼)</div>
    <div class="example-block modal">
      <div class="example-row"><span class="example-en">I <span class="kw-modal">can</span> swim. <em>(ability)</em></span><span class="example-jp">ç§ã¯æ³³ã’ã¾ã™ã€‚ï¼ˆèƒ½åŠ›ï¼‰</span><button class="tts-btn" onclick="speak('I can swim.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en"><span class="kw-modal">Can</span> I open the window? <em>(permission)</em></span><span class="example-jp">çª“ã‚’é–‹ã‘ã¦ã‚‚ã„ã„ã§ã™ã‹ï¼Ÿï¼ˆè¨±å¯ï¼‰</span><button class="tts-btn" onclick="speak('Can I open the window?')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en"><span class="kw-modal">Could</span> you help me? <em>(polite request)</em></span><span class="example-jp">æ‰‹ä¼ã£ã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿï¼ˆä¸å¯§ãªä¾é ¼ï¼‰</span><button class="tts-btn" onclick="speak('Could you help me?')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">I <span class="kw-modal">could</span> run fast when I was young. <em>(past ability)</em></span><span class="example-jp">è‹¥ã„é ƒã¯é€Ÿãèµ°ã‚Œã¾ã—ãŸã€‚ï¼ˆéå»ã®èƒ½åŠ›ï¼‰</span><button class="tts-btn" onclick="speak('I could run fast when I was young.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">2. may / might (ã‹ã‚‚ã—ã‚Œãªã„ãƒ»è¨±å¯)</div>
    <div class="example-block modal">
      <div class="example-row"><span class="example-en">It <span class="kw-modal">may</span> rain tomorrow. <em>(possibility)</em></span><span class="example-jp">æ˜æ—¥ã¯é›¨ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ï¼ˆå¯èƒ½æ€§ï¼‰</span><button class="tts-btn" onclick="speak('It may rain tomorrow.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en"><span class="kw-modal">May</span> I use your phone? <em>(permission)</em></span><span class="example-jp">é›»è©±ã‚’ä½¿ã£ã¦ã‚‚ã„ã„ã§ã™ã‹ï¼Ÿï¼ˆè¨±å¯ï¼‰</span><button class="tts-btn" onclick="speak('May I use your phone?')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">It <span class="kw-modal">might</span> be true. <em>(uncertainty)</em></span><span class="example-jp">ãã‚Œã¯æœ¬å½“ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ï¼ˆä¸ç¢ºã‹ã•ï¼‰</span><button class="tts-btn" onclick="speak('It might be true.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She <span class="kw-modal">might</span> come later. <em>(possibility)</em></span><span class="example-jp">å½¼å¥³ã¯å¾Œã§æ¥ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</span><button class="tts-btn" onclick="speak('She might come later.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">3. must / have to (ç¾©å‹™ãƒ»å¿…è¦ãƒ»ç¦æ­¢)</div>
    <div class="example-block modal">
      <div class="example-row"><span class="example-en">You <span class="kw-modal">must</span> wear a seatbelt. <em>(obligation)</em></span><span class="example-jp">ã‚·ãƒ¼ãƒˆãƒ™ãƒ«ãƒˆã‚’ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ï¼ˆç¾©å‹™ï¼‰</span><button class="tts-btn" onclick="speak('You must wear a seatbelt.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">I <span class="kw-modal">have to</span> finish this. <em>(necessity)</em></span><span class="example-jp">ã“ã‚Œã‚’çµ‚ãˆãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ï¼ˆå¿…è¦ï¼‰</span><button class="tts-btn" onclick="speak('I have to finish this.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">You <span class="kw-modal">must not</span> smoke here. <em>(prohibition)</em></span><span class="example-jp">ã“ã“ã§å–«ç…™ã—ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚ï¼ˆç¦æ­¢ï¼‰</span><button class="tts-btn" onclick="speak('You must not smoke here.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She <span class="kw-modal">doesn't have to</span> come. <em>(no obligation)</em></span><span class="example-jp">å½¼å¥³ã¯æ¥ãªãã¦ã„ã„ã§ã™ã€‚ï¼ˆç¾©å‹™ãªã—ï¼‰</span><button class="tts-btn" onclick="speak('She does not have to come.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">4. should / ought to (ã‚¢ãƒ‰ãƒã‚¤ã‚¹ãƒ»æ¨è–¦)</div>
    <div class="example-block modal">
      <div class="example-row"><span class="example-en">You <span class="kw-modal">should</span> study more. <em>(advice)</em></span><span class="example-jp">ã‚‚ã£ã¨å‹‰å¼·ã™ã¹ãã§ã™ã€‚ï¼ˆã‚¢ãƒ‰ãƒã‚¤ã‚¹ï¼‰</span><button class="tts-btn" onclick="speak('You should study more.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He <span class="kw-modal">ought to</span> apologize. <em>(recommendation)</em></span><span class="example-jp">å½¼ã¯è¬ã‚‹ã¹ãã§ã™ã€‚ï¼ˆæ¨è–¦ï¼‰</span><button class="tts-btn" onclick="speak('He ought to apologize.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">You <span class="kw-modal">shouldn't</span> eat too much. <em>(negative advice)</em></span><span class="example-jp">é£Ÿã¹ã™ãã‚‹ã¹ãã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</span><button class="tts-btn" onclick="speak('You should not eat too much.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en"><span class="kw-modal">Should</span> I call her? <em>(asking advice)</em></span><span class="example-jp">å½¼å¥³ã«é›»è©±ã™ã¹ãã§ã—ã‚‡ã†ã‹ï¼Ÿï¼ˆåŠ©è¨€ã‚’æ±‚ã‚ã‚‹ï¼‰</span><button class="tts-btn" onclick="speak('Should I call her?')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">5. will / would (æœªæ¥ãƒ»ä¸å¯§ãªç”³ã—å‡ºãƒ»æ¡ä»¶)</div>
    <div class="example-block modal">
      <div class="example-row"><span class="example-en">I <span class="kw-modal">will</span> help you. <em>(future)</em></span><span class="example-jp">æ‰‹ä¼ã„ã¾ã™ã€‚ï¼ˆæœªæ¥ï¼‰</span><button class="tts-btn" onclick="speak('I will help you.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en"><span class="kw-modal">Would</span> you like some tea? <em>(polite offer)</em></span><span class="example-jp">ãŠèŒ¶ã¯ã„ã‹ãŒã§ã™ã‹ï¼Ÿï¼ˆä¸å¯§ãªç”³ã—å‡ºï¼‰</span><button class="tts-btn" onclick="speak('Would you like some tea?')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She <span class="kw-modal">will</span> arrive at 6. <em>(future prediction)</em></span><span class="example-jp">å½¼å¥³ã¯6æ™‚ã«åˆ°ç€ã—ã¾ã™ã€‚ï¼ˆæœªæ¥äºˆæ¸¬ï¼‰</span><button class="tts-btn" onclick="speak('She will arrive at 6.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">I <span class="kw-modal">would</span> visit if I could. <em>(conditional)</em></span><span class="example-jp">ã§ãã‚‹ãªã‚‰è¨ªå•ã™ã‚‹ã®ã«ã€‚ï¼ˆæ¡ä»¶ï¼‰</span><button class="tts-btn" onclick="speak('I would visit if I could.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">6. shall (ææ¡ˆãƒ»ç”³ã—å‡º)</div>
    <div class="example-block modal">
      <div class="example-row"><span class="example-en"><span class="kw-modal">Shall</span> we dance? <em>(suggestion)</em></span><span class="example-jp">è¸Šã‚Šã¾ã—ã‚‡ã†ã‹ï¼Ÿï¼ˆææ¡ˆï¼‰</span><button class="tts-btn" onclick="speak('Shall we dance?')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en"><span class="kw-modal">Shall</span> I open the door? <em>(offer)</em></span><span class="example-jp">ãƒ‰ã‚¢ã‚’é–‹ã‘ã¾ã—ã‚‡ã†ã‹ï¼Ÿï¼ˆç”³ã—å‡ºï¼‰</span><button class="tts-btn" onclick="speak('Shall I open the door?')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">We <span class="kw-modal">shall</span> overcome. <em>(formal future)</em></span><span class="example-jp">ç§ãŸã¡ã¯ä¹—ã‚Šè¶Šãˆã‚‹ã ã‚ã†ã€‚ï¼ˆæ ¼å¼ã‚ã‚‹æœªæ¥ï¼‰</span><button class="tts-btn" onclick="speak('We shall overcome.')">ğŸ”Š</button></div>
    </div>

    <div class="sub-title">7. éå»ã®åŠ©å‹•è© (Past Modals)</div>
    <div class="example-block modal">
      <div class="example-row"><span class="example-en">I <span class="kw-modal">should have studied</span> harder.</span><span class="example-jp">ã‚‚ã£ã¨å‹‰å¼·ã™ã¹ãã§ã—ãŸï¼ˆã—ãªã‹ã£ãŸï¼‰ã€‚</span><button class="tts-btn" onclick="speak('I should have studied harder.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">She <span class="kw-modal">could have gone</span> to the party.</span><span class="example-jp">å½¼å¥³ã¯ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã«è¡Œã‘ãŸã®ã«ï¼ˆè¡Œã‹ãªã‹ã£ãŸï¼‰ã€‚</span><button class="tts-btn" onclick="speak('She could have gone to the party.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">He <span class="kw-modal">must have forgotten</span> the meeting.</span><span class="example-jp">å½¼ã¯ä¼šè­°ã‚’å¿˜ã‚ŒãŸã«é•ã„ã‚ã‚Šã¾ã›ã‚“ã€‚</span><button class="tts-btn" onclick="speak('He must have forgotten the meeting.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">They <span class="kw-modal">might have missed</span> the train.</span><span class="example-jp">å½¼ã‚‰ã¯é›»è»Šã‚’ä¹—ã‚Šéã”ã—ãŸã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</span><button class="tts-btn" onclick="speak('They might have missed the train.')">ğŸ”Š</button></div>
      <div class="example-row"><span class="example-en">I <span class="kw-modal">would have helped</span> if I had known.</span><span class="example-jp">çŸ¥ã£ã¦ã„ã‚Œã°æ‰‹ä¼ã£ãŸã®ã«ã€‚</span><button class="tts-btn" onclick="speak('I would have helped if I had known.')">ğŸ”Š</button></div>
    </div>
  </div>

  <!-- MODAL QUIZ -->
  <div class="card quiz-section">
    <div class="card-title"><span class="badge badge-modal">Quiz</span>Practice Quizzes</div>
    <div class="study-mode-hint">Study Mode ON: ã‚¯ã‚¤ã‚ºã¯éè¡¨ç¤ºã§ã™ã€‚</div>
    <div class="quiz-nav">
      <button class="quiz-tab-btn active-modal" onclick="showQuiz('modal','A',this)">Type A: Fill-in-Blank</button>
      <button class="quiz-tab-btn" onclick="showQuiz('modal','B',this)">Type B: Scramble</button>
      <button class="quiz-tab-btn" onclick="showQuiz('modal','C',this)">Type C: Translation</button>
    </div>
    <div class="score-display" id="score-modal">Score: 0 / 0</div>
    <div id="quiz-modal-A" class="quiz-panel active"><div id="modal-A-questions"></div><button class="reset-quiz-btn" onclick="resetQuizA('modal')">Reset Quiz</button></div>
    <div id="quiz-modal-B" class="quiz-panel"><div id="modal-B-scrambles"></div></div>
    <div id="quiz-modal-C" class="quiz-panel"><div id="modal-C-translations"></div></div>
  </div>
</div>

<script>
// ============ QUIZ DATA ============
const quizData = {
  pp: {
    A: [
      {q:"I ___ already eaten dinner.",choices:["have","has","had","am"],ans:0,hint:"ç¾åœ¨å®Œäº†å½¢: I + have"},
      {q:"She ___ gone to the library.",choices:["have","has","is","was"],ans:1,hint:"She + has (ç¾åœ¨å®Œäº†)"},
      {q:"The letter was ___ by my mother.",choices:["write","wrote","written","writing"],ans:2,hint:"å—å‹•æ…‹ã§ã¯éå»åˆ†è©ã‚’ä½¿ã†"},
      {q:"The window was ___ by the ball.",choices:["break","broke","broken","breaking"],ans:2,hint:"was + éå»åˆ†è© (broken)"},
      {q:"Look at that ___ car. It's very old.",choices:["use","uses","used","using"],ans:2,hint:"å½¢å®¹è©ã¨ã—ã¦: used car (ä¸­å¤è»Š)"},
      {q:"The students look ___. The lesson is boring.",choices:["bored","boring","bore","bores"],ans:0,hint:"æ„Ÿæƒ…ã‚’è¡¨ã™: bored (é€€å±ˆã—ãŸ)"},
      {q:"We have ___ our homework.",choices:["finish","finishes","finished","finishing"],ans:2,hint:"have + éå»åˆ†è© (finished)"},
      {q:"They ___ a decision last week.",choices:["have made","has made","made","make"],ans:2,hint:"last weekãŒã‚ã‚‹ã®ã§éå»å½¢"},
      {q:"She got ___ at the party.",choices:["excite","excites","excited","exciting"],ans:2,hint:"get + éå»åˆ†è©: get excited"},
      {q:"He has ___ the window.",choices:["break","broke","broken","breaking"],ans:2,hint:"has + éå»åˆ†è© (broken)"}
    ],
    B: [
      {jp:"å½¼å¥³ã¯ã™ã§ã«å®¿é¡Œã‚’çµ‚ãˆã¾ã—ãŸã€‚",words:["She","has","already","finished","her","homework","."],answer:"She has already finished her homework ."},
      {jp:"ãã®æ‰‹ç´™ã¯æ˜¨æ—¥é€ã‚‰ã‚Œã¾ã—ãŸã€‚",words:["The","letter","was","sent","yesterday","."],answer:"The letter was sent yesterday ."},
      {jp:"ç§ã¯ç–²ã‚Œã¦é“ã«è¿·ã„ã¾ã—ãŸã€‚",words:["I","got","tired","and","lost","."],answer:"I got tired and lost ."},
      {jp:"ãã®æœ¬ã¯ãƒ˜ãƒŸãƒ³ã‚°ã‚¦ã‚§ã‚¤ã«ã‚ˆã£ã¦æ›¸ã‹ã‚Œã¾ã—ãŸã€‚",words:["The","book","was","written","by","Hemingway","."],answer:"The book was written by Hemingway ."},
      {jp:"å½¼ã‚‰ã¯é‡è¦ãªæ±ºæ–­ã‚’ä¸‹ã—ã¾ã—ãŸã€‚",words:["They","have","made","an","important","decision","."],answer:"They have made an important decision ."}
    ],
    C: [
      {jp:"çª“ã¯å‰²ã‚Œã¦ã„ã¾ã™ã€‚",en:"The window is broken.",audio:"The window is broken."},
      {jp:"ç§ã¯ã™ã§ã«æ˜¼é£Ÿã‚’é£Ÿã¹ã¾ã—ãŸã€‚",en:"I have already eaten lunch.",audio:"I have already eaten lunch."},
      {jp:"ãã®å®¶ã¯1990å¹´ã«å»ºã¦ã‚‰ã‚Œã¾ã—ãŸã€‚",en:"The house was built in 1990.",audio:"The house was built in 1990."},
      {jp:"ã‚±ãƒ¼ã‚­ã¯å­ä¾›ãŸã¡ã«é£Ÿã¹ã‚‰ã‚Œã¾ã—ãŸã€‚",en:"The cake was eaten by the children.",audio:"The cake was eaten by the children."},
      {jp:"å½¼ã¯è‹¥ã„é ƒã€é€Ÿãèµ°ã‚Œã¾ã—ãŸã€‚",en:"He could run fast when he was young.",audio:"He could run fast when he was young."}
    ]
  },
  ger: {
    A: [
      {q:"___ is my favorite hobby. (swim)",choices:["Swim","Swims","Swimming","To swim"],ans:2,hint:"ä¸»èªã¨ã—ã¦: Swimming (å‹•åè©)"},
      {q:"I enjoy ___ books in the evening.",choices:["read","reads","reading","to read"],ans:2,hint:"enjoy ã®å¾Œã¯å‹•åè©"},
      {q:"She finished ___ the report.",choices:["write","writes","writing","to write"],ans:2,hint:"finish ã®å¾Œã¯å‹•åè©"},
      {q:"He avoided ___ to his boss.",choices:["talk","talks","talking","to talk"],ans:2,hint:"avoid ã®å¾Œã¯å‹•åè©"},
      {q:"They suggest ___ a taxi.",choices:["take","takes","taking","to take"],ans:2,hint:"suggest ã®å¾Œã¯å‹•åè©"},
      {q:"She is good at ___.",choices:["cook","cooks","cooking","to cook"],ans:2,hint:"å‰ç½®è© at ã®å¾Œã¯å‹•åè©"},
      {q:"He is interested in ___ Japanese.",choices:["learn","learns","learning","to learn"],ans:2,hint:"å‰ç½®è© in ã®å¾Œã¯å‹•åè©"},
      {q:"We are tired of ___.",choices:["wait","waits","waiting","to wait"],ans:2,hint:"å‰ç½®è© of ã®å¾Œã¯å‹•åè©"},
      {q:"___ every day is good for your health.",choices:["Run","Runs","Running","To running"],ans:2,hint:"ä¸»èªã¨ã—ã¦å‹•åè© Running"},
      {q:"Would you mind ___ the window?",choices:["open","opens","opening","to open"],ans:2,hint:"mind ã®å¾Œã¯å‹•åè©"}
    ],
    B: [
      {jp:"æ°´æ³³ã¯æ¥½ã—ã„ã§ã™ã€‚",words:["Swimming","is","fun","."],answer:"Swimming is fun ."},
      {jp:"å½¼å¥³ã¯æ–™ç†ãŒå¾—æ„ã§ã™ã€‚",words:["She","is","good","at","cooking","."],answer:"She is good at cooking ."},
      {jp:"ç§ã¯èª­æ›¸ã‚’æ¥½ã—ã¿ã¾ã™ã€‚",words:["I","enjoy","reading","books","."],answer:"I enjoy reading books ."},
      {jp:"æ¯æ—¥èµ°ã‚‹ã“ã¨ã¯å¥åº·ã‚’ä¿ã¡ã¾ã™ã€‚",words:["Running","every","day","keeps","you","healthy","."],answer:"Running every day keeps you healthy ."},
      {jp:"å½¼å¥³ã¯æ—¥æœ¬èªå­¦ç¿’ã«èˆˆå‘³ãŒã‚ã‚Šã¾ã™ã€‚",words:["She","is","interested","in","learning","Japanese","."],answer:"She is interested in learning Japanese ."}
    ],
    C: [
      {jp:"æœ¬ã‚’èª­ã‚€ã“ã¨ã¯å¤§åˆ‡ã§ã™ã€‚",en:"Reading books is important.",audio:"Reading books is important."},
      {jp:"å½¼ã¯å½¼å¥³ã¨è©±ã™ã“ã¨ã‚’é¿ã‘ã¾ã—ãŸã€‚",en:"He avoided talking to her.",audio:"He avoided talking to her."},
      {jp:"ç§ã¯é£›è¡Œæ©ŸãŒæ€–ã„ã§ã™ã€‚",en:"I am afraid of flying.",audio:"I am afraid of flying."},
      {jp:"å½¼ã‚‰ã¯æ±äº¬ã¸ã®å¼•è¶Šã—ã‚’æ¤œè¨ã—ã¦ã„ã¾ã™ã€‚",en:"They consider moving to Tokyo.",audio:"They consider moving to Tokyo."},
      {jp:"é£Ÿäº‹ã‚’ä½œã‚‹ã“ã¨ã¯æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚",en:"Cooking meals takes time.",audio:"Cooking meals takes time."}
    ]
  },
  inf: {
    A: [
      {q:"I want ___ to Japan someday.",choices:["go","goes","going","to go"],ans:3,hint:"want ã®å¾Œã¯ toä¸å®šè©"},
      {q:"She decided ___ early.",choices:["leave","leaves","leaving","to leave"],ans:3,hint:"decide ã®å¾Œã¯ toä¸å®šè©"},
      {q:"He needs ___ more.",choices:["study","studies","studying","to study"],ans:3,hint:"need ã®å¾Œã¯ toä¸å®šè©"},
      {q:"We went to the store ___ milk.",choices:["buy","buys","buying","to buy"],ans:3,hint:"ç›®çš„ã‚’è¡¨ã™ toä¸å®šè©"},
      {q:"It is important ___ every day.",choices:["practice","practices","practicing","to practice"],ans:3,hint:"It is + adj + toä¸å®šè©"},
      {q:"She is too tired ___ now.",choices:["work","works","working","to work"],ans:3,hint:"too + adj + toä¸å®šè©"},
      {q:"He is old enough ___.",choices:["vote","votes","voting","to vote"],ans:3,hint:"adj + enough + toä¸å®šè©"},
      {q:"They promised ___ us.",choices:["help","helps","helping","to help"],ans:3,hint:"promise ã®å¾Œã¯ toä¸å®šè©"},
      {q:"I am happy ___ you.",choices:["meet","meets","meeting","to meet"],ans:3,hint:"å½¢å®¹è©ã®å¾Œ: happy to meet"},
      {q:"She refused ___ the question.",choices:["answer","answers","answering","to answer"],ans:3,hint:"refuse ã®å¾Œã¯ toä¸å®šè©"}
    ],
    B: [
      {jp:"ç§ã¯ãƒ‘ãƒªã«è¡ŒããŸã„ã§ã™ã€‚",words:["I","want","to","go","to","Paris","."],answer:"I want to go to Paris ."},
      {jp:"è©¦é¨“ã«åˆæ ¼ã™ã‚‹ãŸã‚ã«ä¸€ç”Ÿæ‡¸å‘½å‹‰å¼·ã—ã¾ã—ãŸã€‚",words:["She","studied","hard","to","pass","the","exam","."],answer:"She studied hard to pass the exam ."},
      {jp:"ç–²ã‚Œã™ãã¦ä»•äº‹ã§ãã¾ã›ã‚“ã€‚",words:["I","am","too","tired","to","work","."],answer:"I am too tired to work ."},
      {jp:"æ¯æ—¥å‹‰å¼·ã™ã‚‹ã“ã¨ã¯å¤§åˆ‡ã§ã™ã€‚",words:["It","is","important","to","study","every","day","."],answer:"It is important to study every day ."},
      {jp:"å½¼å¥³ã¯æŠ•ç¥¨ã§ãã‚‹å¹´é½¢ã§ã™ã€‚",words:["She","is","old","enough","to","vote","."],answer:"She is old enough to vote ."}
    ],
    C: [
      {jp:"ç§ã¯æ—©ãå‡ºç™ºã™ã‚‹ã“ã¨ã«æ±ºã‚ã¾ã—ãŸã€‚",en:"I decided to leave early.",audio:"I decided to leave early."},
      {jp:"ãã‚Œã‚’èã„ã¦å¬‰ã—ã„ã§ã™ã€‚",en:"I am happy to hear that.",audio:"I am happy to hear that."},
      {jp:"æµ·å¤–æ—…è¡Œã¯æ¥½ã—ã„ã§ã™ã€‚",en:"It is fun to travel abroad.",audio:"It is fun to travel abroad."},
      {jp:"å½¼å¥³ã¯è»Šã‚’è²·ã†ãŸã‚ã«ãŠé‡‘ã‚’è²¯ã‚ã¾ã—ãŸã€‚",en:"She saved money to buy a car.",audio:"She saved money to buy a car."},
      {jp:"é‡ã™ãã¦æŒã¡ä¸Šã’ã‚‰ã‚Œã¾ã›ã‚“ã€‚",en:"It is too heavy to lift.",audio:"It is too heavy to lift."}
    ]
  },
  prep: {
    A: [
      {q:"The meeting starts ___ 9am.",choices:["at","on","in","by"],ans:0,hint:"æ™‚åˆ»ã«ã¯ at ã‚’ä½¿ã†"},
      {q:"She was born ___ Monday.",choices:["at","on","in","by"],ans:1,hint:"æ›œæ—¥ã«ã¯ on ã‚’ä½¿ã†"},
      {q:"I was born ___ 2000.",choices:["at","on","in","by"],ans:2,hint:"å¹´ã«ã¯ in ã‚’ä½¿ã†"},
      {q:"The book is ___ the table.",choices:["at","on","in","under"],ans:1,hint:"è¡¨é¢ã®ä¸Šã«ã¯ on ã‚’ä½¿ã†"},
      {q:"He lives ___ Japan.",choices:["at","on","in","to"],ans:2,hint:"å›½ãƒ»åœ°åŸŸã«ã¯ in ã‚’ä½¿ã†"},
      {q:"She went ___ school this morning.",choices:["at","on","in","to"],ans:3,hint:"ç§»å‹•å…ˆã«ã¯ to ã‚’ä½¿ã†"},
      {q:"I am interested ___ music.",choices:["at","on","in","for"],ans:2,hint:"interested in (ç†Ÿèª)"},
      {q:"He is good ___ math.",choices:["at","on","in","for"],ans:0,hint:"good at (ç†Ÿèª)"},
      {q:"We are tired ___ waiting.",choices:["at","on","of","for"],ans:2,hint:"tired of (ç†Ÿèª)"},
      {q:"She walked ___ the room.",choices:["to","into","in","on"],ans:1,hint:"å†…éƒ¨ã¸ã®ç§»å‹•: into"}
    ],
    B: [
      {jp:"å½¼å¥³ã¯æœˆæ›œæ—¥ã«å­¦æ ¡ã«è¡Œãã¾ã™ã€‚",words:["She","goes","to","school","on","Monday","."],answer:"She goes to school on Monday ."},
      {jp:"æœ¬ã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸Šã«ã‚ã‚Šã¾ã™ã€‚",words:["The","book","is","on","the","table","."],answer:"The book is on the table ."},
      {jp:"ç§ã¯éŸ³æ¥½ã«èˆˆå‘³ãŒã‚ã‚Šã¾ã™ã€‚",words:["I","am","interested","in","music","."],answer:"I am interested in music ."},
      {jp:"å½¼å¥³ã¯éƒ¨å±‹ã«æ­©ã„ã¦å…¥ã‚Šã¾ã—ãŸã€‚",words:["She","walked","into","the","room","."],answer:"She walked into the room ."},
      {jp:"ç§ã¯æœã«è‹±èªã‚’å‹‰å¼·ã—ã¾ã™ã€‚",words:["I","study","English","in","the","morning","."],answer:"I study English in the morning ."}
    ],
    C: [
      {jp:"ä¼šè­°ã¯åˆå¾Œ3æ™‚ã§ã™ã€‚",en:"The meeting is at 3pm.",audio:"The meeting is at 3pm."},
      {jp:"å½¼å¥³ã¯æ•°å­¦ãŒå¾—æ„ã§ã™ã€‚",en:"She is good at math.",audio:"She is good at math."},
      {jp:"å½¼ã¯æ—¥æœ¬ã«ä½ã‚“ã§ã„ã¾ã™ã€‚",en:"He lives in Japan.",audio:"He lives in Japan."},
      {jp:"ãŠä¼šã„ã™ã‚‹ã®ã‚’æ¥½ã—ã¿ã«ã—ã¦ã„ã¾ã™ã€‚",en:"I look forward to meeting you.",audio:"I look forward to meeting you."},
      {jp:"ç§ãŸã¡ã¯å…¬åœ’ã‚’é€šã‚ŠæŠœã‘ã¾ã—ãŸã€‚",en:"We walked through the park.",audio:"We walked through the park."}
    ]
  },
  modal: {
    A: [
      {q:"I ___ swim very well. (ability)",choices:["can","must","should","shall"],ans:0,hint:"èƒ½åŠ›ã‚’è¡¨ã™: can"},
      {q:"___ I use your phone? (polite permission)",choices:["Can","May","Must","Shall"],ans:1,hint:"ä¸å¯§ãªè¨±å¯: May"},
      {q:"You ___ wear a seatbelt. It's the law.",choices:["can","may","must","would"],ans:2,hint:"ç¾©å‹™ãƒ»æ³•å¾‹: must"},
      {q:"It ___ rain tomorrow. The sky is cloudy.",choices:["must","should","might","shall"],ans:2,hint:"å¯èƒ½æ€§: might"},
      {q:"You ___ study more. Your grades are low.",choices:["can","may","should","shall"],ans:2,hint:"ã‚¢ãƒ‰ãƒã‚¤ã‚¹: should"},
      {q:"___ you like some coffee?",choices:["Will","Would","Shall","Must"],ans:1,hint:"ä¸å¯§ãªç”³ã—å‡º: Would"},
      {q:"You ___ not smoke in this building.",choices:["can","should","must","might"],ans:2,hint:"ç¦æ­¢: must not"},
      {q:"She ___ come later. I'm not sure.",choices:["must","shall","might","can"],ans:2,hint:"ä¸ç¢ºã‹ã•: might"},
      {q:"___ we go for a walk?",choices:["Will","Would","Shall","Must"],ans:2,hint:"ææ¡ˆ: Shall we"},
      {q:"I ___ have studied harder. I failed.",choices:["must","should","can","may"],ans:1,hint:"éå»ã®å¾Œæ‚”: should have"}
    ],
    B: [
      {jp:"çª“ã‚’é–‹ã‘ã¦ã‚‚ã„ã„ã§ã™ã‹ï¼Ÿ",words:["Can","I","open","the","window","?"],answer:"Can I open the window ?"},
      {jp:"ã‚ãªãŸã¯ã‚‚ã£ã¨å‹‰å¼·ã™ã¹ãã§ã™ã€‚",words:["You","should","study","more","."],answer:"You should study more ."},
      {jp:"æ˜æ—¥ã¯é›¨ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚",words:["It","might","rain","tomorrow","."],answer:"It might rain tomorrow ."},
      {jp:"è¸Šã‚Šã¾ã—ã‚‡ã†ã‹ï¼Ÿ",words:["Shall","we","dance","?"],answer:"Shall we dance ?"},
      {jp:"å½¼ã¯ä¼šè­°ã‚’å¿˜ã‚ŒãŸã«é•ã„ã‚ã‚Šã¾ã›ã‚“ã€‚",words:["He","must","have","forgotten","the","meeting","."],answer:"He must have forgotten the meeting ."}
    ],
    C: [
      {jp:"æ‰‹ä¼ã£ã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ",en:"Could you help me?",audio:"Could you help me?"},
      {jp:"ã“ã“ã§å–«ç…™ã—ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚",en:"You must not smoke here.",audio:"You must not smoke here."},
      {jp:"ç§ã¯ã‚‚ã£ã¨å‹‰å¼·ã™ã¹ãã§ã—ãŸã€‚",en:"I should have studied harder.",audio:"I should have studied harder."},
      {jp:"ãŠèŒ¶ã¯ã„ã‹ãŒã§ã™ã‹ï¼Ÿ",en:"Would you like some tea?",audio:"Would you like some tea?"},
      {jp:"ãƒ‰ã‚¢ã‚’é–‹ã‘ã¾ã—ã‚‡ã†ã‹ï¼Ÿ",en:"Shall I open the door?",audio:"Shall I open the door?"}
    ]
  }
};

// ============ STATE ============
const state = JSON.parse(localStorage.getItem('egState') || '{}');
// state structure: {pp:{A:{0:{answered:true,correct:true},...},B:{...},C:{...}}, ger:{...}, ...}

function saveState(){localStorage.setItem('egState',JSON.stringify(state));}

function initTopicState(topic){
  if(!state[topic]) state[topic]={A:{},B:{},C:{}};
  if(!state[topic].A) state[topic].A={};
  if(!state[topic].B) state[topic].B={};
  if(!state[topic].C) state[topic].C={};
}

// ============ SCORE ============
function calcScore(topic){
  initTopicState(topic);
  let correct=0, total=0;
  ['A','B','C'].forEach(type=>{
    const data = quizData[topic][type];
    data.forEach((_,i)=>{
      const s = state[topic][type][i];
      if(s){ total++; if(s.correct) correct++; }
    });
  });
  return {correct,total};
}

function updateScore(topic){
  const {correct,total}=calcScore(topic);
  document.getElementById('score-'+topic).textContent='Score: '+correct+' / '+total;
  updateGlobalProgress();
}

function updateGlobalProgress(){
  let tc=0,tt=0;
  ['pp','ger','inf','prep','modal'].forEach(t=>{
    const s=calcScore(t);
    tc+=s.correct; tt+=s.total;
  });
  const pct = tt>0?Math.round(tc/tt*100):0;
  document.getElementById('progressFill').style.width=pct+'%';
  document.getElementById('progressLabel').textContent=tc+' / '+tt+' correct ('+pct+'%)';
}

// ============ TTS ============
function speak(text){
  if(!window.speechSynthesis) return alert('ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯TTSã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚');
  window.speechSynthesis.cancel();
  const u=new SpeechSynthesisUtterance(text);
  u.lang='en-US'; u.rate=0.9;
  window.speechSynthesis.speak(u);
}

// ============ TOPIC NAV ============
function showTopic(topic,btn){
  document.querySelectorAll('.topic-section').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));
  document.getElementById('section-'+topic).classList.add('active');
  btn.classList.add('active');
}

// ============ QUIZ NAV ============
function showQuiz(topic,type,btn){
  const panels = document.querySelectorAll('#section-'+topic+' .quiz-panel');
  panels.forEach(p=>p.classList.remove('active'));
  document.getElementById('quiz-'+topic+'-'+type).classList.add('active');
  const btns = document.querySelectorAll('#section-'+topic+' .quiz-tab-btn');
  btns.forEach(b=>b.className='quiz-tab-btn');
  btn.className='quiz-tab-btn active-'+topic;
}

// ============ QUIZ A ============
function buildQuizA(topic){
  initTopicState(topic);
  const container=document.getElementById(topic+'-A-questions');
  container.innerHTML='';
  quizData[topic].A.forEach((q,i)=>{
    const div=document.createElement('div');
    div.className='quiz-question';
    div.id='qa-'+topic+'-'+i;
    const saved=state[topic].A[i];
    div.innerHTML=`<p><strong>Q${i+1}.</strong> ${q.q}</p>
    <div class="quiz-choices" id="qac-${topic}-${i}"></div>
    <div class="quiz-feedback" id="qaf-${topic}-${i}"></div>`;
    container.appendChild(div);
    const choicesDiv=document.getElementById('qac-'+topic+'-'+i);
    q.choices.forEach((c,ci)=>{
      const btn=document.createElement('button');
      btn.className='choice-btn';
      btn.textContent=c;
      if(saved){
        btn.disabled=true;
        if(ci===q.ans) btn.classList.add('correct');
        else if(ci===saved.chosen) btn.classList.add('wrong');
      }
      btn.onclick=()=>answerA(topic,i,ci,q.ans,q.hint);
      choicesDiv.appendChild(btn);
    });
    if(saved){
      const fb=document.getElementById('qaf-'+topic+'-'+i);
      fb.classList.add('show');
      if(saved.correct){fb.classList.add('ok');fb.textContent='Correct!';}
      else{fb.classList.add('ng');fb.textContent='Wrong. Hint: '+q.hint;}
    }
  });
  updateScore(topic);
}

function answerA(topic,qi,chosen,ans,hint){
  if(state[topic].A[qi]) return;
  const correct=chosen===ans;
  state[topic].A[qi]={answered:true,correct,chosen};
  saveState();
  const choicesDiv=document.getElementById('qac-'+topic+'-'+qi);
  Array.from(choicesDiv.children).forEach((btn,ci)=>{
    btn.disabled=true;
    if(ci===ans) btn.classList.add('correct');
    else if(ci===chosen) btn.classList.add('wrong');
  });
  const fb=document.getElementById('qaf-'+topic+'-'+qi);
  fb.classList.add('show');
  if(correct){fb.classList.add('ok');fb.textContent='Correct! Well done!';}
  else{fb.classList.add('ng');fb.textContent='Wrong. Hint: '+hint;}
  updateScore(topic);
}

function resetQuizA(topic){
  state[topic].A={};
  saveState();
  buildQuizA(topic);
}

// ============ QUIZ B (SCRAMBLE) ============
function buildQuizB(topic){
  initTopicState(topic);
  const container=document.getElementById(topic+'-B-scrambles');
  container.innerHTML='';
  quizData[topic].B.forEach((q,i)=>{
    const shuffled=[...q.words].sort(()=>Math.random()-.5);
    const div=document.createElement('div');
    div.className='scramble-question';
    div.innerHTML=`
      <div class="scramble-prompt">ä¸¦ã³æ›¿ãˆã¦è‹±æ–‡ã‚’ä½œã£ã¦ãã ã•ã„:</div>
      <div class="scramble-jp">${q.jp}</div>
      <div class="answer-area" id="sba-${topic}-${i}"></div>
      <div class="word-bank" id="sbb-${topic}-${i}"></div>
      <div>
        <button class="scramble-check-btn" onclick="checkScramble('${topic}',${i})">Check</button>
        <button class="scramble-reset-btn" onclick="resetScramble('${topic}',${i})">Reset</button>
      </div>
      <div class="scramble-result" id="sbr-${topic}-${i}"></div>`;
    container.appendChild(div);
    const bank=document.getElementById('sbb-'+topic+'-'+i);
    shuffled.forEach((w,wi)=>{
      const chip=document.createElement('span');
      chip.className='word-chip';
      chip.textContent=w;
      chip.dataset.word=w;
      chip.dataset.idx=wi;
      chip.onclick=()=>moveToAnswer(chip,topic,i);
      bank.appendChild(chip);
    });
  });
}

function moveToAnswer(chip,topic,i){
  const ansArea=document.getElementById('sba-'+topic+'-'+i);
  const bank=document.getElementById('sbb-'+topic+'-'+i);
  if(chip.parentElement===bank){
    chip.classList.add('in-answer');
    ansArea.appendChild(chip);
    chip.onclick=()=>moveToBank(chip,topic,i);
  }
}

function moveToBank(chip,topic,i){
  const bank=document.getElementById('sbb-'+topic+'-'+i);
  chip.classList.remove('in-answer');
  bank.appendChild(chip);
  chip.onclick=()=>moveToAnswer(chip,topic,i);
}

function checkScramble(topic,i){
  const ansArea=document.getElementById('sba-'+topic+'-'+i);
  const chips=Array.from(ansArea.children);
  const ans=chips.map(c=>c.textContent).join(' ');
  const correct=quizData[topic].B[i].answer;
  const res=document.getElementById('sbr-'+topic+'-'+i);
  res.classList.add('show');
  const isCorrect=ans.trim()===correct.trim();
  if(isCorrect){
    res.classList.add('ok');res.classList.remove('ng');
    res.textContent='Correct! '+correct;
    state[topic].B[i]={answered:true,correct:true};
  } else {
    res.classList.add('ng');res.classList.remove('ok');
    res.textContent='Try again! Answer: '+correct;
    state[topic].B[i]={answered:true,correct:false};
  }
  saveState();
  updateScore(topic);
}

function resetScramble(topic,i){
  const ansArea=document.getElementById('sba-'+topic+'-'+i);
  const bank=document.getElementById('sbb-'+topic+'-'+i);
  const res=document.getElementById('sbr-'+topic+'-'+i);
  Array.from(ansArea.children).forEach(chip=>{
    chip.classList.remove('in-answer');
    bank.appendChild(chip);
    chip.onclick=()=>moveToAnswer(chip,topic,i);
  });
  res.classList.remove('show','ok','ng');
  res.textContent='';
}

// ============ QUIZ C (TRANSLATION) ============
function buildQuizC(topic){
  const container=document.getElementById(topic+'-C-translations');
  container.innerHTML='';
  quizData[topic].C.forEach((q,i)=>{
    const div=document.createElement('div');
    div.className='trans-question';
    div.innerHTML=`
      <div class="trans-jp"><strong>Q${i+1}.</strong> ${q.jp}</div>
      <button class="trans-show-btn" id="tsb-${topic}-${i}" onclick="toggleTrans('${topic}',${i})">Show Answer</button>
      <div class="trans-answer" id="tsa-${topic}-${i}">
        ${q.en}
        <button class="trans-audio-btn" onclick="speak('${q.audio}')">ğŸ”Š</button>
      </div>`;
    container.appendChild(div);
  });
}

function toggleTrans(topic,i){
  const ans=document.getElementById('tsa-'+topic+'-'+i);
  const btn=document.getElementById('tsb-'+topic+'-'+i);
  if(ans.classList.contains('show')){
    ans.classList.remove('show');
    btn.textContent='Show Answer';
  } else {
    ans.classList.add('show');
    btn.textContent='Hide Answer';
    if(!state[topic].C[i]){
      state[topic].C[i]={answered:true,correct:true};
      saveState();
      updateScore(topic);
    }
  }
}

// ============ STUDY MODE ============
function toggleStudyMode(chk){
  if(chk.checked) document.body.classList.add('study-mode');
  else document.body.classList.remove('study-mode');
}

// ============ INIT ============
function init(){
  ['pp','ger','inf','prep','modal'].forEach(t=>{
    initTopicState(t);
    buildQuizA(t);
    buildQuizB(t);
    buildQuizC(t);
  });
  updateGlobalProgress();
}

window.addEventListener('load',init);
</script>
</body>
</html>
